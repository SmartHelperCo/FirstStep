http://pastecode.ru/96a727/